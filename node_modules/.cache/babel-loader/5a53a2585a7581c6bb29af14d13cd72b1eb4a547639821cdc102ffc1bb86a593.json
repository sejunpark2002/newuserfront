{"ast":null,"code":"import React from'react';import{useState}from'react';import Button from'@mui/material/Button';import{addUserAPI}from'../api/addUserApi';import{Stack}from'@mui/system';import{Typography,TextField}from'@mui/material';import{storage}from'../firebase.config';import{ref,uploadBytes,getDownloadURL,listAll,deleteObject}from'firebase/storage';import{useAppDispatch,useAppSelector}from'../store';import{createUserAction}from'../redux/userAction';import{getUserAPI}from'../api/getUserApi';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UpdateUser=_ref=>{let{selecteduser,onClose}=_ref;const dispatch=useAppDispatch();const[userInfo,setUserInfo]=useState({name:selecteduser.name,email:selecteduser.email,phone:selecteduser.phone});const[image,setImage]=useState(null);const changeUserInfo=e=>{const{name,value}=e.target;setUserInfo({...userInfo,[name]:value});};const handleUploadImage=e=>{const{files}=e.target;if(files!==null&&files!==void 0&&files.length){setImage(files[0]);}};const deleteImageInStorage=async imagePath=>{const imageRef=ref(storage,imagePath);const result=await deleteObject(imageRef);console.log(result);};const submitChange=async()=>{try{let imageUrl=selecteduser.imageUrl;let imgPath=selecteduser.imagePath;if(image){await deleteImageInStorage(selecteduser.imagePath);const currentTime=Date.now();const imgPath=\"images/\".concat(image.name,\"_\").concat(currentTime);const imageRef=ref(storage,imgPath);await uploadBytes(imageRef,image);imageUrl=await getDownloadURL(imageRef);}const newUser={id:selecteduser.id,name:userInfo.name,email:userInfo.email,phone:userInfo.phone,imageUrl:imageUrl,imagePath:imgPath,timeCreated:selecteduser.timeCreated// imageUrl:imgUrl as string\n};const res=await fetch(\"\".concat(process.env.REACT_APP_API_ADDRESS_DEV),{method:'PUT',body:JSON.stringify(newUser),headers:{'Content-Type':'application/json'}});onClose();const result=await getUserAPI();dispatch(createUserAction(result));}catch(err){console.log(err);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Stack,{children:[/*#__PURE__*/_jsx(Typography,{sx:{color:'#344054',fontSize:'13px'},mb:'5px',children:\"Name\"}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"name\",value:userInfo.name,onChange:changeUserInfo,size:\"small\",sx:{width:'100%',height:'34px',mb:'20px'}}),/*#__PURE__*/_jsx(Typography,{sx:{color:'#344054',fontSize:'13px'},mb:'5px',children:\"Email\"}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"email\",value:userInfo.email,onChange:changeUserInfo,size:\"small\",sx:{width:'100%',height:'34px',mb:'20px'}}),/*#__PURE__*/_jsx(Typography,{sx:{color:'#344054',fontSize:'13px'},mb:'5px',children:\"Phone\"}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"phone\",value:userInfo.phone,onChange:changeUserInfo,size:\"small\",sx:{width:'100%',height:'34px',mb:'20px'}}),/*#__PURE__*/_jsx(Typography,{sx:{color:'#344054',fontSize:'13px'},mb:'5px',children:\"Profile Picture\"}),/*#__PURE__*/_jsx(TextField,{type:\"file\",onChange:handleUploadImage,size:\"small\",sx:{width:'100%',height:'34px',mb:'20px'}}),/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:2,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",sx:{bgcolor:'#FFC401','&:hover':{borderColor:'#436AE9',// Keep the same color on hover\nbackgroundColor:'#E6B337',color:'#FFFFFF',borderWidth:'2px'// Ensure the border width stays the same on hover\n}},onClick:()=>{submitChange();},children:\"Edit User\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",sx:{borderColor:'#FFC401',color:'#FFC401','&:hover':{borderColor:'#FFC401',// Keep the same color on hover\nbackgroundColor:'#F0F0F0'// Ensure the border width stays the same on hover\n}},onClick:onClose,children:\"Cancel\"})]})]})});};export default UpdateUser;","map":{"version":3,"names":["React","useState","Button","addUserAPI","Stack","Typography","TextField","storage","ref","uploadBytes","getDownloadURL","listAll","deleteObject","useAppDispatch","useAppSelector","createUserAction","getUserAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UpdateUser","_ref","selecteduser","onClose","dispatch","userInfo","setUserInfo","name","email","phone","image","setImage","changeUserInfo","e","value","target","handleUploadImage","files","length","deleteImageInStorage","imagePath","imageRef","result","console","log","submitChange","imageUrl","imgPath","currentTime","Date","now","concat","newUser","id","timeCreated","res","fetch","process","env","REACT_APP_API_ADDRESS_DEV","method","body","JSON","stringify","headers","err","children","sx","color","fontSize","mb","type","onChange","size","width","height","direction","spacing","variant","bgcolor","borderColor","backgroundColor","borderWidth","onClick"],"sources":["/Users/sejunpark/Lesson/newusermanagement/src/components/UpdateUser.jsx"],"sourcesContent":["import React from 'react'\nimport {useState} from 'react'\nimport Button from '@mui/material/Button';\nimport {addUserAPI} from '../api/addUserApi'\nimport { Stack } from '@mui/system';\nimport { Typography,TextField } from '@mui/material';\nimport { storage } from '../firebase.config'\nimport { ref, uploadBytes, getDownloadURL, listAll, deleteObject } from 'firebase/storage'\nimport {useAppDispatch,useAppSelector} from '../store';\nimport {createUserAction} from '../redux/userAction'\nimport { getUserAPI } from '../api/getUserApi';\n\n\n\nconst UpdateUser = ({selecteduser,onClose}) => {\n  const dispatch = useAppDispatch()\n\n  const [userInfo,setUserInfo] = useState({\n    name:selecteduser.name,\n    email:selecteduser.email,\n    phone:selecteduser.phone\n  })\n\n  const [image, setImage] = useState(null)\n\n\n  const changeUserInfo = (e) => { \n    const {name,value} = e.target\n    setUserInfo({...userInfo,[name]:value})\n    }\n\n   const handleUploadImage = (e) => {\n      const {files} = e.target\n      if(files?.length) {\n        setImage(files[0]);\n      } \n    }\n  \n    const deleteImageInStorage = async (imagePath)=> {\n      const imageRef = ref(storage, imagePath)\n      const result = await deleteObject(imageRef)\n      console.log(result)\n    }\n    \n\n\n   const submitChange = async () => {\n    try {\n    let imageUrl = selecteduser.imageUrl\n    let imgPath = selecteduser.imagePath\n\n    if(image) {\n      await deleteImageInStorage(selecteduser.imagePath)\n      const currentTime = Date.now();\n      const imgPath = `images/${image.name}_${currentTime}`\n      const imageRef = ref(storage,imgPath);\n      await uploadBytes(imageRef,image)\n      imageUrl = await getDownloadURL(imageRef)  \n    }\n \n      const newUser={\n        id: selecteduser.id,\n        name: userInfo.name,\n        email: userInfo.email,\n        phone: userInfo.phone,\n        imageUrl: imageUrl,\n        imagePath: imgPath,\n        timeCreated: selecteduser.timeCreated\n        // imageUrl:imgUrl as string\n      }\n  \n      const res = await fetch(`${process.env.REACT_APP_API_ADDRESS_DEV}`,{\n        method:'PUT',\n        body: JSON.stringify(newUser),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n      onClose();\n      const result = await getUserAPI();\n      dispatch(createUserAction(result))\n      \n    } catch (err) {\n      console.log(err);\n    }\n   \n\n}\n\n  \n  return (\n    <>\n      <Stack>\n        <Typography sx={{color:'#344054',fontSize:'13px'}} mb={'5px'}>Name</Typography>\n        <TextField type='text' name=\"name\" value={userInfo.name} onChange={changeUserInfo} size='small' sx = {{width:'100%',height:'34px',mb:'20px'}}/>\n        <Typography sx={{color:'#344054',fontSize:'13px'}} mb={'5px'}>Email</Typography>\n        <TextField type='text' name=\"email\" value={userInfo.email} onChange={changeUserInfo} size='small' sx = {{width:'100%',height:'34px',mb:'20px'}}/>\n        <Typography  sx={{color:'#344054',fontSize:'13px'}} mb={'5px'}>Phone</Typography>\n        <TextField type='text' name=\"phone\" value={userInfo.phone} onChange={changeUserInfo} size='small' sx = {{width:'100%',height:'34px',mb:'20px'}}/>\n        <Typography  sx={{color:'#344054',fontSize:'13px'}} mb={'5px'}>Profile Picture</Typography>\n        <TextField type='file'  onChange={handleUploadImage} size='small' sx = {{width:'100%',height:'34px',mb:'20px'}}/>\n        <Stack direction=\"row\" spacing={2}>\n          <Button variant=\"contained\" \n                  sx={{bgcolor:'#FFC401',\n                    '&:hover': {\n                        borderColor: '#436AE9', // Keep the same color on hover\n                        backgroundColor: '#E6B337',\n                        color:'#FFFFFF',\n                        borderWidth: '2px', // Ensure the border width stays the same on hover\n                         },\n                  }} \n                  onClick={()=>{submitChange()}}>\n                  Edit User</Button>\n          <Button variant=\"outlined\"\n                  sx={{borderColor:'#FFC401',\n                       color:'#FFC401',\n                       '&:hover': {\n                        borderColor: '#FFC401', // Keep the same color on hover\n                        backgroundColor: '#F0F0F0',\n                     // Ensure the border width stays the same on hover\n                         } \n                  }}\n                   onClick={onClose}>Cancel</Button>\n\n        </Stack>\n     \n       \n      </Stack>\n     \n    </>\n  )\n}\n\nexport default UpdateUser"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}